<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kufta — Clean Street Food</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --black:#0b0b0b; --dark:#111; --mid:#444; --muted:#888; --white:#ffffff;
    --red:#e63946; --red-dark:#b22a34; --container:1100px;
    --shadow:0 8px 28px rgba(0,0,0,0.08);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:"Poppins",system-ui,-apple-system,Segoe UI,Roboto,Arial;
    color:var(--black); background:var(--white);
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }
  a{color:inherit;text-decoration:none}
  img{max-width:100%;display:block}
  .container{max-width:var(--container);margin:0 auto;padding:0 18px}
  .btn{background:var(--red);color:#fff;border:none;padding:12px 18px;border-radius:10px;font-weight:700;cursor:pointer}
  .btn:hover{background:var(--red-dark)}
  .btn.ghost{background:#fff;border:1px solid #eee;color:var(--black)}
  .pill{padding:8px 12px;border-radius:999px;border:1px solid #eee;background:#fff;cursor:pointer;white-space:nowrap}
  .pill.active{border-color:var(--red);color:var(--red)}
  .card{background:#fff;border:1px solid #eee;border-radius:12px;box-shadow:var(--shadow)}
  .small{font-size:0.92rem;color:var(--muted)}
  .muted{color:var(--muted)}
  /* Top */
  .top{position:sticky;top:0;z-index:1200;background:#fff;border-bottom:1px solid #eee;backdrop-filter:blur(6px)}
  .logo-wrap{display:flex;align-items:center;justify-content:center;gap:16px;padding:12px 0}
  .logo-wrap img{width:140px;height:auto}
  .hotline{font-size:14px;color:var(--black);font-weight:700}
  .nav{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;padding:10px 0 16px}
  .nav a{font-weight:600;padding:8px 10px;border-radius:8px}
  .nav a:hover{color:var(--red)}
  /* Hero */
  .hero{display:grid;grid-template-columns:1fr 360px;gap:22px;align-items:center;padding:34px 0}
  .hero h1{margin:0 0 10px;font-size:clamp(26px,4vw,40px);letter-spacing:.3px}
  .hero p{margin:0 0 12px;color:var(--muted)}
  .quick{padding:16px}
  /* Menu + Cart */
  .menu-section{padding:42px 0}
  .cat-scroll{display:flex;gap:10px;overflow:auto;padding-bottom:8px;scroll-snap-type:x mandatory}
  .cat-scroll .pill{scroll-snap-align:start}
  .menu-wrap{display:grid;grid-template-columns:1fr 360px;gap:18px;align-items:start}
  .menu-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px}
  .item{overflow:hidden}
  .item img{width:100%;height:160px;object-fit:cover}
  .item-body{padding:12px}
  .item h3{margin:0 0 6px;font-size:18px}
  .item p{margin:0;color:var(--muted);font-size:14px}
  .item-foot{display:flex;align-items:center;justify-content:space-between;margin-top:10px}
  .price{font-weight:800;color:var(--red)}
  .cart{position:sticky;top:90px}
  .cart .panel{padding:14px}
  .cart-item{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px dashed #eee}
  .qty-btn{background:#fff;border:1px solid #eee;padding:6px;border-radius:6px;cursor:pointer;margin-left:6px}
  /* Sticky checkout bar */
  .checkout-bar{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid #eee;box-shadow:0 -6px 20px rgba(0,0,0,0.06);padding:10px 14px;display:none;z-index:1200}
  .checkout-inner{max-width:var(--container);margin:0 auto;display:flex;justify-content:space-between;align-items:center;gap:10px}
  /* Promotions */
  .promos{padding:42px 0;background:#111;color:#fff}
  .promos h2{margin:0 0 14px;text-align:center}
  .promo-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
  .promo-card{background:#1b1b1b;border:1px solid #222;border-radius:12px;padding:14px}
  /* Branches + Map (accordion) */
  .branches{padding:42px 0}
  .branches-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;margin-bottom:12px}
  .map-iframe{width:100%;height:320px;border:0;border-radius:10px}
  .acc{border:1px solid #eee;border-radius:10px;overflow:hidden}
  .acc h3{margin:0}
  .acc button{width:100%;text-align:left;background:#fff;border:0;padding:14px 16px;font-weight:700;cursor:pointer}
  .acc button::after{content:"▾";float:right;color:var(--muted)}
  .acc .acc-panel{display:none;padding:0 16px 16px;background:#fff}
  /* Survey */
  .stars{display:flex;gap:6px;font-size:22px;color:#ddd;cursor:pointer}
  .star.sel{color:var(--red)}
  /* Contact */
  .contact{padding:42px 0;background:#111;color:#fff}
  .contact .card{background:#111;border-color:#222}
  .contact input,.contact select,.contact textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #333;background:#0b0b0b;color:#fff}
  /* Footer + WhatsApp */
  footer{background:#0b0b0b;color:#fff;text-align:center;padding:18px}
  .socials{display:flex;gap:10px;justify-content:center;margin-top:8px}
  .socials a{width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:8px;background:rgba(255,255,255,.06)}
  .wa-fab{position:fixed;right:16px;bottom:72px;width:52px;height:52px;border-radius:999px;background:#25d366;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:var(--shadow);z-index:1200}
  /* Responsive */
  @media (max-width:980px){
    .hero{grid-template-columns:1fr}
    .menu-wrap{grid-template-columns:1fr}
    .cart{position:relative;top:auto}
  }
  @media (max-width:560px){
    .item img{height:140px}
    .logo-wrap img{width:120px}
  }
</style>
</head>
<body>

<!-- TOP -->
<header class="top">
  <div class="container">
    <div class="logo-wrap">
      <!-- Put logo.jpg next to this file -->
      <img src="logo.jpg" alt="Kufta logo">
      <div class="hotline">Hotline: <strong>15544</strong></div>
    </div>
    <nav class="nav">
      <a href="#home" onclick="to('home')">Home</a>
      <a href="#menu" onclick="to('menu')">Menu</a>
      <a href="#promotions" onclick="to('promotions')">Promotions</a>
      <a href="#branches" onclick="to('branches')">Branches</a>
      <a href="#survey" onclick="to('survey')">Feedback</a>
      <a href="#contact" onclick="to('contact')">Contact</a>
      <a href="#order" onclick="to('order')">Order</a>
    </nav>
  </div>
</header>

<!-- HERO -->
<section id="home" class="container hero">
  <div>
    <h1>Kufta — Clean Street Food</h1>
    <p>Authentic Kufta, Hawawshi & boxes. Order online or visit our branches.</p>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <button class="btn" onclick="to('menu')">Explore Menu</button>
      <button class="btn ghost" onclick="to('order')">Order Now</button>
    </div>
  </div>
  <aside class="card quick">
    <h3 style="margin:0 0 8px">Quick Order</h3>
    <p class="small" style="margin:0 0 10px">Pick an item & quantity — it goes to your cart.</p>
    <label class="small">Item</label>
    <select id="quick-item" style="width:100%;padding:10px;border-radius:8px;border:1px solid #eee"></select>
    <div style="display:flex;gap:8px;margin-top:10px">
      <input id="quick-qty" type="number" min="1" value="1" style="flex:1;padding:10px;border-radius:8px;border:1px solid #eee">
      <button class="btn" onclick="addQuick()">Add</button>
    </div>
  </aside>
</section>

<!-- MENU -->
<section id="menu" class="menu-section">
  <div class="container">
    <h2 style="text-align:center;margin:0 0 12px">Menu & Order</h2>

    <!-- Category tabs (scrollable) -->
    <div class="cat-scroll" id="cat-tabs" aria-label="Categories"></div>

    <div class="menu-wrap" style="margin-top:14px">
      <!-- Grid -->
      <div>
        <div id="menu-grid" class="menu-grid"></div>
      </div>

      <!-- Cart -->
      <aside class="cart">
        <div class="card panel">
          <h3 style="margin-top:0">Your Cart</h3>
          <div id="cart-items" class="small">Cart is empty</div>

          <div style="margin-top:12px">
            <label class="small">Choose Branch</label>
            <select id="branch-select" style="width:100%;padding:10px;border-radius:8px;border:1px solid #eee"></select>
          </div>

          <div style="margin-top:12px">
            <label class="small">Promo Code</label>
            <div style="display:flex;gap:8px">
              <input id="checkout-promo" type="text" placeholder="Enter promo code" style="flex:1;padding:10px;border-radius:8px;border:1px solid #eee">
              <button onclick="applyCheckoutPromo()" class="btn">Apply</button>
            </div>
            <div id="promo-feedback" class="small" style="margin-top:8px;color:#e63946"></div>
          </div>

          <div style="display:flex;justify-content:space-between;margin-top:12px">
            <span class="small">Subtotal</span><strong id="cart-subtotal">0 EGP</strong>
          </div>
          <div style="display:flex;justify-content:space-between;margin-top:6px">
            <span class="small">Discount</span><strong id="cart-discount">0 EGP</strong>
          </div>
          <div style="display:flex;justify-content:space-between;margin-top:6px">
            <span class="small">Total</span><strong id="cart-total">0 EGP</strong>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px">
            <button class="btn" onclick="to('order')">Checkout</button>
            <button class="btn ghost" onclick="clearCart()">Clear</button>
          </div>
        </div>
      </aside>
    </div>
  </div>
</section>

<!-- PROMOTIONS -->
<section id="promotions" class="promos">
  <div class="container">
    <h2>Promotions & Promo Codes</h2>
    <p class="small" style="text-align:center;margin:0 0 12px">Use at checkout: <strong>3ALADEEMO</strong>, <strong>WELCOME10</strong>, <strong>FREEFRIES</strong></p>
    <div id="promo-grid" class="promo-grid"></div>
  </div>
</section>

<!-- BRANCHES + MAP (Accordion) -->
<section id="branches" class="branches">
  <div class="container">
    <h2 style="text-align:center;margin:0 0 12px">Branches</h2>
    <div id="branches-grid" class="branches-grid"></div>
    <div style="text-align:center;margin-top:10px">
      <button class="btn ghost" id="showMoreBranches" onclick="toggleBranches()">Show More</button>
    </div>

    <div class="acc" style="margin-top:16px">
      <button type="button" onclick="acc(this)">View Map (Downtown Cairo)</button>
      <div class="acc-panel">
        <div style="padding-top:12px">
          <iframe class="map-iframe"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3457.20!2d31.235712!3d30.044420!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x145841e6b2bdc6b1%3A0x0!2sTalaat%20Harb%20St%2C%20Downtown%20Cairo!5e0!3m2!1sen!2seg!4v1696600000000"
            loading="lazy"></iframe>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- SURVEY (Accordion) -->
<section id="survey" class="branches">
  <div class="container">
    <div class="acc">
      <button type="button" onclick="acc(this)">Feedback & Survey (with Receipt)</button>
      <div class="acc-panel">
        <div class="card" style="margin-top:14px;padding:16px">
          <p class="small">Enter your receipt number, pick a branch and rate your experience.</p>
          <form id="survey-form" onsubmit="return submitSurvey(event)">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
              <div><label class="small">Receipt Number</label><input id="survey-receipt" type="text" placeholder="e.g. 2025-0001" required></div>
              <div><label class="small">Branch</label><select id="survey-branch"></select></div>
            </div>
            <div style="margin-top:10px"><label class="small">Your Name (optional)</label><input id="survey-name" type="text" placeholder="Full name"></div>
            <div style="margin-top:10px"><label class="small">Rating</label>
              <div id="rating-stars" class="stars" role="radiogroup" aria-label="Rating">
                <span class="star" data-v="1">★</span><span class="star" data-v="2">★</span><span class="star" data-v="3">★</span><span class="star" data-v="4">★</span><span class="star" data-v="5">★</span>
              </div>
            </div>
            <div style="margin-top:10px"><label class="small">Comments</label><textarea id="survey-comments" placeholder="Tell us about your experience..." required></textarea></div>
            <div style="margin-top:12px;display:flex;gap:8px">
              <button class="btn" type="submit">Submit Feedback</button>
              <button class="btn ghost" type="button" onclick="document.getElementById('survey-form').reset(); setRating(0);">Reset</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ORDER / CHECKOUT -->
<section id="order" class="branches">
  <div class="container">
    <div class="acc">
      <button type="button" onclick="acc(this)">Checkout</button>
      <div class="acc-panel">
        <div class="card" style="margin-top:14px;padding:16px">
          <form id="checkout-form" onsubmit="return submitCheckout(event)">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
              <div><label class="small">Full Name</label><input id="chk-name" type="text" required></div>
              <div><label class="small">Phone</label><input id="chk-phone" type="tel" required></div>
            </div>
            <div style="margin-top:10px"><label class="small">Delivery Address</label><textarea id="chk-address" required></textarea></div>

            <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
              <label class="small" style="margin:0">Promo</label>
              <input id="chk-promo" type="text" placeholder="Promo code (optional)" style="flex:1;padding:10px;border-radius:8px;border:1px solid #eee">
              <button type="button" class="btn" onclick="applyPromoAtCheckout()">Apply</button>
            </div>
            <div id="chk-promo-msg" class="small" style="margin-top:6px;color:#e63946"></div>

            <div style="margin-top:12px">
              <table style="width:100%;border-collapse:collapse" id="checkout-summary">
                <tr><td style="padding:10px;border:1px solid #eee" colspan="3" class="small muted">Your cart is empty</td></tr>
              </table>
            </div>

            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px">
              <div class="small">Subtotal</div><div id="checkout-sub">0 EGP</div>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px">
              <div class="small">Discount</div><div id="checkout-disc">0 EGP</div>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px;font-weight:800">
              <div>Total</div><div id="checkout-total">0 EGP</div>
            </div>

            <div style="margin-top:12px">
              <button class="btn" type="submit">Place Order</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CONTACT (Accordion, dark) -->
<section id="contact" class="contact">
  <div class="container">
    <div class="acc" style="border-color:#222">
      <button type="button" onclick="acc(this)">Contact / Franchise / Careers</button>
      <div class="acc-panel">
        <div class="card" style="margin-top:14px;padding:16px;border-color:#222">
          <form id="contact-form" onsubmit="return submitContactForm(event)">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
              <div>
                <label class="small">Inquiry type</label>
                <select id="contact-type">
                  <option>General Inquiry</option>
                  <option>Franchise Request</option>
                  <option>Career Opportunity</option>
                </select>
              </div>
              <div>
                <label class="small">Phone</label>
                <input id="contact-phone" type="tel" placeholder="Phone">
              </div>
            </div>
            <div style="margin-top:10px">
              <label class="small">Full name</label>
              <input id="contact-name" type="text" placeholder="Full name" required>
            </div>
            <div style="margin-top:10px">
              <label class="small">Email</label>
              <input id="contact-email" type="email" placeholder="Email" required>
            </div>
            <div style="margin-top:10px">
              <label class="small">Message</label>
              <textarea id="contact-message" placeholder="Tell us about your inquiry..." required></textarea>
            </div>
            <div style="margin-top:12px">
              <button class="btn" type="submit">Send Message</button>
              <a class="btn ghost" style="margin-left:8px" href="https://wa.me/?text=Hi%20Kufta" target="_blank" rel="noopener">Open WhatsApp</a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <div>Kufta • Hotline <strong>15544</strong> • © 2025</div>
  <div class="socials" aria-hidden="false">
    <a href="#" title="Instagram" aria-label="Instagram">
      <svg width="18" height="18" viewBox="0 0 24 24"><path fill="white" d="M12 2.2c3.2 0 3.6 0 4.9.1 1.2.1 1.9.3 2.4.5.6.3 1 .6 1.5 1.1s.8 1 1.1 1.5c.2.5.4 1.2.5 2.4.1 1.3.1 1.7.1 4.9s0 3.6-.1 4.9c-.1 1.2-.3 1.9-.5 2.4-.3.6-.6 1-1.1 1.5s-1 0-1.5 1.1c-.5.2-1.2.4-2.4.5-1.3.1-1.7.1-4.9.1s-3.6 0-4.9-.1c-1.2-.1-1.9-.3-2.4-.5-.6-.3-1-.6-1.5-1.1S2.6 20 2.3 19.4c-.2-.5-.4-1.2-.5-2.4C1.6 15.7 1.6 15.3 1.6 12s0-3.6.1-4.9c.1-1.2.3-1.9.5-2.4.3-.6.6-1 1.1-1.5S5 2.9 5.5 2.6C6 .2 6.7 2.2 12 2.2z"/></svg>
    </a>
    <a href="#" title="Facebook" aria-label="Facebook">
      <svg width="18" height="18" viewBox="0 0 24 24"><path fill="white" d="M22 12.1C22 6.6 17.5 2 12 2S2 6.6 2 12.1c0 5 3.7 9.2 8.5 9.9v-7H8.1v-2.9h2.4V9.2c0-2.4 1.4-3.8 3.6-3.8 1 0 2 .2 2 .2v2.2h-1.1c-1.1 0-1.4.7-1.4 1.4v1.7h2.5l-.4 2.9h-2.1v7C18.3 21.3 22 17.1 22 12.1z"/></svg>
    </a>
    <a href="https://wa.me/?text=Hi%20Kufta" title="WhatsApp" aria-label="WhatsApp" target="_blank" rel="noopener">
      <svg width="18" height="18" viewBox="0 0 24 24"><path fill="white" d="M20.5 3.5C18.9 2 16.8 1 14.5 1 8.8 1 4 5.8 4 11.5c0 1.9.5 3.8 1.5 5.4L4 23l6.2-1.6c1.5.8 3.1 1.3 4.8 1.3 5.7 0 10.5-4.8 10.5-10.5 0-2.3-1-4.4-2.9-6z"/></svg>
    </a>
  </div>
</footer>

<!-- WhatsApp floating shortcut (no number yet) -->
<a class="wa-fab" href="https://wa.me/?text=Hi%20Kufta" target="_blank" rel="noopener" title="Open WhatsApp" aria-label="WhatsApp">
  <svg width="26" height="26" viewBox="0 0 24 24" fill="white"><path d="M20.5 3.5C18.9 2 16.8 1 14.5 1 8.8 1 4 5.8 4 11.5c0 1.9.5 3.8 1.5 5.4L4 23l6.2-1.6c1.5.8 3.1 1.3 4.8 1.3 5.7 0 10.5-4.8 10.5-10.5 0-2.3-1-4.4-2.9-6z"/></svg>
</a>

<!-- Sticky checkout bar -->
<div class="checkout-bar" id="checkout-bar">
  <div class="checkout-inner">
    <div><strong id="bar-count">0</strong> items • <strong id="bar-total">0 EGP</strong></div>
    <button class="btn" onclick="to('order')">Checkout</button>
  </div>
</div>

<script>
/* ===== Data ===== */
const MENU = [
  // Sandwiches
  {cat:'Sandwiches', name:'Kufta Sandwich', price:45, desc:'Grilled kofta, tahini, pickles, salad', img:'https://images.unsplash.com/photo-1601050690597-1f38f1f83a07?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Sandwiches', name:'Hawawshi', price:60, desc:'Traditional Egyptian spiced meat bread', img:'https://images.unsplash.com/photo-1604908553958-593b3d8894d4?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Sandwiches', name:'Kufta Double', price:105, desc:'Double portion of kufta', img:'https://images.unsplash.com/photo-1606732803863-24b3f2d4ef7c?auto=format&fit=crop&w=1000&q=60'},
  // Boxes
  {cat:'Boxes', name:'3 Sandwiches Box', price:170, desc:'Mix of Kufta/Hawawshi', img:'https://images.unsplash.com/photo-1567620832903-9fc6debc209f?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Boxes', name:'4 Sandwiches Box', price:225, desc:'Mix of Kufta/Hawawshi', img:'https://images.unsplash.com/photo-1552332386-f8dd00dc2f85?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Boxes', name:'8 Sandwiches Box', price:450, desc:'Family bundle', img:'https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Boxes', name:'10 Sandwiches Box', price:560, desc:'Party box', img:'https://images.unsplash.com/photo-1539136788836-5699e78bfc75?auto=format&fit=crop&w=1000&q=60'},
  // Sides
  {cat:'Sides', name:'Potato Chips', price:15, desc:'Freshly fried chips', img:'https://images.unsplash.com/photo-1544025162-d76694265947?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Sides', name:'Egyptian Salad', price:15, desc:'Fresh baladi salad', img:'https://images.unsplash.com/photo-1551183053-bf91a1d81141?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Sides', name:'Tahini', price:15, desc:'Classic tahini dip', img:'https://images.unsplash.com/photo-1523292562811-8fa7962a78c8?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Sides', name:'Spicy Tahini', price:15, desc:'Tahini with heat', img:'https://images.unsplash.com/photo-1523292562811-8fa7962a78c8?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Sides', name:'Pickled Tomatoes', price:15, desc:'House pickles', img:'https://images.unsplash.com/photo-1537774965631-6e5e9f03b3a3?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Sides', name:'Mixed Pickles / Cucumber', price:10, desc:'Crunchy pickles', img:'https://images.unsplash.com/photo-1512621776951-a57141f2eefd?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Sides', name:'Whiskey (Salad Drink)', price:15, desc:'Tangy salad drink', img:'https://images.unsplash.com/photo-1517705008128-361805f42e86?auto=format&fit=crop&w=1000&q=60'},
  // Drinks
  {cat:'Drinks', name:'Rayeb Lemon & Blueberry', price:25, desc:'Refreshing drink', img:'https://images.unsplash.com/photo-1542444459-db4d4b3d1b2b?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Drinks', name:'Tabasko (Fruity & Spicy)', price:25, desc:'Fruity & spicy', img:'https://images.unsplash.com/photo-1541976076758-347942db1970?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Drinks', name:'V7', price:25, desc:'Energy drink', img:'https://images.unsplash.com/photo-1600275669283-4b6e01b3a8a5?auto=format&fit=crop&w=1000&q=60'},
  {cat:'Drinks', name:'Mineral Water', price:15, desc:'Still water', img:'https://images.unsplash.com/photo-1502741338009-cac2772e18bc?auto=format&fit=crop&w=1000&q=60'}
];

const BRANCHES = [
  {name:'Downtown (Talaat Harb)', addr:'Talaat Harb St, Downtown Cairo', hours:'10:00 - 02:00', phone:'15544'},
  {name:'Zamalek', addr:'Street 123, Zamalek, Cairo', hours:'10:00 - 02:00', phone:'15544'},
  {name:'North Coast (Marina)', addr:'Marina Gate 5, North Coast', hours:'Seasonal hours', phone:'15544'},
  {name:'Dokki', addr:'45 Dokki Rd, Giza', hours:'10:00 - 01:00', phone:'15544'},
  {name:'Nasr City', addr:'Central Plaza, Nasr City', hours:'11:00 - 00:00', phone:'15544'},
  {name:'Heliopolis', addr:'Heliopolis Main St', hours:'11:00 - 00:00', phone:'15544'},
  {name:'Maadi', addr:'Maadi Corniche', hours:'10:00 - 01:00', phone:'15544'}
];

const PROMOS = {
  '3ALADEEMO': {type:'percent', amt:15, min:150, note:'15% off orders over 150 EGP'},
  'WELCOME10': {type:'percent', amt:10, min:100, note:'10% off first orders over 100 EGP'},
  'FREEFRIES': {type:'freeitem', item:'Potato Chips', min:0, note:'Free Potato Chips with any sandwich'}
};

/* ===== State ===== */
let activeCat = 'All';
let cart = [];
let appliedPromo = null;
let showAllBranches = false;
let rating = 0;

/* ===== Helpers ===== */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
const money = n => Math.round(n) + ' EGP';
function to(id){ const el = document.getElementById(id); if(!el) return; const top = document.querySelector('.top').offsetHeight || 80; const y = el.getBoundingClientRect().top + window.pageYOffset - top - 8; window.scrollTo({top:y,behavior:'smooth'}); }
function openMap(addr){ window.open('https://www.google.com/maps/search/?api=1&query=' + encodeURIComponent(addr),'_blank'); }

/* ===== Menu Render ===== */
function cats(){ return ['All', ...new Set(MENU.map(m=>m.cat))]; }
function renderTabs(){
  const box = $('#cat-tabs'); box.innerHTML = '';
  cats().forEach(c=>{
    const b = document.createElement('button');
    b.className = 'pill' + (c===activeCat?' active':''); b.textContent = c;
    b.onclick = () => { activeCat = c; renderMenu(); };
    box.appendChild(b);
  });
}
function renderMenu(){
  const grid = $('#menu-grid'); grid.innerHTML='';
  const list = activeCat==='All' ? MENU : MENU.filter(m=>m.cat===activeCat);
  list.forEach(m=>{
    const art = document.createElement('article');
    art.className = 'card item';
    art.innerHTML = `
      <img src="${m.img}" alt="${m.name}">
      <div class="item-body">
        <div><h3>${m.name}</h3><p>${m.desc}</p></div>
        <div class="item-foot"><div class="price">${m.price} EGP</div>
          <button class="btn" onclick="addToCart('${m.name.replace(/'/g,"\\'")}', ${m.price})">Add</button>
        </div>
      </div>`;
    grid.appendChild(art);
  });
  // Quick select (Sandwiches for speed)
  const qs = $('#quick-item'); qs.innerHTML='';
  MENU.filter(m=>m.cat==='Sandwiches').forEach(m=>{
    const o = document.createElement('option');
    o.value = `${m.name}|${m.price}`; o.textContent = `${m.name} — ${m.price} EGP`;
    qs.appendChild(o);
  });
}

/* ===== Branches ===== */
function renderBranches(){
  const grid = $('#branches-grid'); grid.innerHTML='';
  const list = showAllBranches ? BRANCHES : BRANCHES.slice(0,3);
  list.forEach(b=>{
    const c = document.createElement('div'); c.className='card'; c.style.padding='14px';
    c.innerHTML = `<h3 style="margin:0 0 6px">${b.name}</h3>
      <div class="small">${b.addr}<br>Hours: ${b.hours}<br>Hotline: ${b.phone}</div>
      <div style="margin-top:10px"><button class="btn ghost" onclick="openMap('${b.addr}')">Open in Google Maps</button></div>`;
    grid.appendChild(c);
  });
  $('#showMoreBranches').textContent = showAllBranches ? 'Show Less' : 'Show More';

  // Fill selects
  const sel = $('#branch-select'); const s2 = $('#survey-branch');
  sel.innerHTML=''; s2.innerHTML='';
  BRANCHES.forEach(b=>{ const o=document.createElement('option'); o.value=b.name; o.textContent=b.name; sel.appendChild(o); s2.appendChild(o.cloneNode(true)); });
}
function toggleBranches(){ showAllBranches = !showAllBranches; renderBranches(); }

/* ===== Cart ===== */
function addQuick(){
  const [name, price] = $('#quick-item').value.split('|'); const qty = Number($('#quick-qty').value||1);
  const f = cart.find(i=>i.name===name);
  if(f) f.qty+=qty; else cart.push({name,price:Number(price),qty});
  renderCart();
}
function addToCart(name, price){
  const f = cart.find(i=>i.name===name);
  if(f) f.qty++; else cart.push({name,price,qty:1});
  renderCart();
}
function changeQty(i, d){ cart[i].qty += d; if(cart[i].qty<1) cart[i].qty=1; renderCart(); }
function removeItem(i){ cart.splice(i,1); renderCart(); }
function clearCart(){ cart=[]; appliedPromo=null; $('#checkout-promo').value=''; $('#promo-feedback').textContent=''; renderCart(); }
function totals(){
  const sub = cart.reduce((s,i)=>s + i.price*i.qty, 0);
  let disc = 0;
  if(appliedPromo){
    const p = PROMOS[appliedPromo];
    if(p.type==='percent' && sub >= p.min) disc = Math.round(sub * (p.amt/100));
    if(p.type==='freeitem'){
      const fries = MENU.find(m=>/potato/i.test(m.name) || /fries/i.test(m.name)); disc = fries ? fries.price : 15;
    }
  }
  return {sub, disc, total: sub-disc};
}
function renderCart(){
  const box = $('#cart-items'); const sum = $('#checkout-summary');
  box.innerHTML=''; sum.innerHTML='';
  if(cart.length===0){
    box.textContent='Cart is empty';
    sum.innerHTML = '<tr><td style="padding:10px;border:1px solid #eee" colspan="3" class="small muted">Your cart is empty</td></tr>';
    $('#cart-subtotal').textContent='0 EGP'; $('#cart-discount').textContent='0 EGP'; $('#cart-total').textContent='0 EGP';
    $('#checkout-sub').textContent='0 EGP'; $('#checkout-disc').textContent='0 EGP'; $('#checkout-total').textContent='0 EGP';
    document.getElementById('checkout-bar').style.display='none';
    return;
  }
  cart.forEach((c,i)=>{
    const row = document.createElement('div'); row.className='cart-item';
    row.innerHTML = `<div><strong>${c.name}</strong><div class="small">${c.qty} × ${c.price} EGP</div></div>
      <div style="text-align:right">
        <div style="font-weight:700">${c.price*c.qty} EGP</div>
        <div style="margin-top:6px">
          <button class="qty-btn" onclick="changeQty(${i},-1)">-</button>
          <button class="qty-btn" onclick="changeQty(${i},1)">+</button>
          <button style="background:transparent;border:none;color:${'#d62828'};margin-left:8px;cursor:pointer" onclick="removeItem(${i})">Remove</button>
        </div>
      </div>`;
    box.appendChild(row);

    const tr = document.createElement('tr');
    tr.innerHTML = `<td style="padding:10px;border:1px solid #eee">${c.name}</td>
                    <td style="padding:10px;border:1px solid #eee">${c.qty}</td>
                    <td style="padding:10px;border:1px solid #eee">${c.price*c.qty} EGP</td>`;
    sum.appendChild(tr);
  });
  const t = totals();
  $('#cart-subtotal').textContent = money(t.sub);
  $('#cart-discount').textContent = money(t.disc);
  $('#cart-total').textContent = money(t.total);
  $('#checkout-sub').textContent = money(t.sub);
  $('#checkout-disc').textContent = money(t.disc);
  $('#checkout-total').textContent = money(t.total);

  // Sticky checkout bar
  document.getElementById('checkout-bar').style.display='block';
  document.getElementById('bar-count').textContent = cart.reduce((s,i)=>s+i.qty,0);
  document.getElementById('bar-total').textContent = money(t.total);
}

/* ===== Promos ===== */
function renderPromos(){
  const p = $('#promo-grid'); p.innerHTML='';
  Object.entries(PROMOS).forEach(([code,info])=>{
    const d = document.createElement('div'); d.className='promo-card';
    d.innerHTML = `<strong>${code}</strong><div class="small" style="margin-top:6px">${info.note}</div>`;
    p.appendChild(d);
  });
}
function applyCheckoutPromo(){ const code = ($('#checkout-promo').value||'').trim().toUpperCase(); applyPromo(code,'#promo-feedback'); }
function applyPromoAtCheckout(){ const code = ($('#chk-promo').value||'').trim().toUpperCase(); applyPromo(code,'#chk-promo-msg'); }
function applyPromo(code, sel){
  const fb = document.querySelector(sel);
  if(!code){ fb.textContent='Enter a promo code.'; fb.style.color='#e63946'; return; }
  const p = PROMOS[code]; if(!p){ fb.textContent='Invalid promo code.'; fb.style.color='#e63946'; return; }
  const sub = cart.reduce((s,i)=>s+i.price*i.qty,0);
  if(p.type==='percent' && sub < p.min){ fb.textContent=`Minimum ${p.min} EGP required.`; fb.style.color='#e63946'; return; }
  if(p.type==='freeitem' && !cart.some(i=>/kufta|hawawshi|sandwich/i.test(i.name))){ fb.textContent='Requires at least one sandwich in cart.'; fb.style.color='#e63946'; return; }
  appliedPromo = code; fb.textContent = `Applied: ${p.note}`; fb.style.color = '#0b7a4d';
  if(code==='FREEFRIES'){ const have = cart.find(i=>/Potato Chips/i.test(i.name)); if(!have) cart.push({name:'Potato Chips', price:0, qty:1}); }
  renderCart();
}

/* ===== Checkout / Contact / Survey ===== */
function submitCheckout(e){
  e.preventDefault();
  if(cart.length===0){ alert('Cart is empty'); to('menu'); return false; }
  const payload = {
    branch: $('#branch-select').value,
    name: $('#chk-name').value,
    phone: $('#chk-phone').value,
    address: $('#chk-address').value,
    promo: ($('#chk-promo').value||null),
    items: cart
  };
  alert('Order submitted (demo). Check console for payload.');
  console.log('ORDER', payload);
  cart=[]; appliedPromo=null; renderCart(); e.target.reset();
  return false;
}
function submitContactForm(e){
  e.preventDefault();
  const data={ type:$('#contact-type').value, name:$('#contact-name').value, phone:$('#contact-phone').value, email:$('#contact-email').value, message:$('#contact-message').value };
  alert('Message sent (demo).'); console.log('CONTACT', data); e.target.reset(); return false;
}
function setRating(v){ rating=v; $$('#rating-stars .star').forEach(s=>s.classList.toggle('sel', Number(s.dataset.v)<=v)); }
function submitSurvey(e){
  e.preventDefault();
  const payload={ receipt:$('#survey-receipt').value, branch:$('#survey-branch').value, name:$('#survey-name').value||null, rating, comments:$('#survey-comments').value };
  if(!rating){ alert('Please select a rating'); return false; }
  alert('Survey submitted (demo).'); console.log('SURVEY', payload);
  rating=0; setRating(0); e.target.reset(); return false;
}

/* ===== Accordions ===== */
function acc(btn){
  const panel = btn.nextElementSibling;
  const open = panel.style.display==='block';
  document.querySelectorAll('.acc .acc-panel').forEach(p=>p.style.display='none');
  if(!open) panel.style.display='block';
}

/* ===== Init ===== */
function init(){
  renderTabs(); renderMenu(); renderPromos(); renderBranches(); renderCart();
  // rating stars click
  $$('#rating-stars .star').forEach(s=> s.onclick = ()=> setRating(Number(s.dataset.v)));
  // default open map accordion on desktop
  if(window.innerWidth>980){ document.querySelectorAll('.acc .acc-panel')[0]?.style && (document.querySelectorAll('.acc .acc-panel')[0].style.display='block'); }
}
init();
</script>
</body>
</html>
